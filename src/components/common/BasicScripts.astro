<script>
	import { OverlayScrollbars } from 'overlayscrollbars'

	// add global scroll bar
	const setupScrollBar = () => {
		OverlayScrollbars(
			{ target: document.body, cancel: { nativeScrollbarsOverlaid: true } },
			{
				scrollbars: {
					theme: 'scrollbar-base scrollbar-auto py-1',
					autoHide: 'move',
				},
			}
		)
		document.body.classList.remove('overflow-y-hidden')

		// add scrollbar for code blocks
		document.querySelectorAll('pre').forEach((ele) => {
			OverlayScrollbars(ele, {
				scrollbars: {
					theme: 'scrollbar-base scrollbar-dark px-2',
					autoHide: 'leave',
					autoHideDelay: 500,
					autoHideSuspend: false,
				},
			})
		})
	}

	const setup = (): void => {
		setupScrollBar()
	}

	document.addEventListener('DOMContentLoaded', setup)
	if (window.swup?.hooks) {
		setup()
	} else {
		document.addEventListener('swup:enable', () => {
			window.swup.hooks.on('content:replace', setup)
		})
	}
</script>
